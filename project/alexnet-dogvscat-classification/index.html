<!DOCTYPE html><html lang="en"><meta name="viewport" content="width=device-width, initial-scale=1.0"></meta><head><meta charset="UTF-8"/><meta name="og:site_name" content="Just Code with Khanh"/><link rel="canonical" href="https://justcodewithkhanh.com/project/alexnet-dogvscat-classification"/><meta name="twitter:url" content="https://justcodewithkhanh.com/project/alexnet-dogvscat-classification"/><meta name="og:url" content="https://justcodewithkhanh.com/project/alexnet-dogvscat-classification"/><title>Keras AlexNet: Dog vs. Cat Classification | Just Code with Khanh</title><meta name="twitter:title" content="Keras AlexNet: Dog vs. Cat Classification | Just Code with Khanh"/><meta name="og:title" content="Keras AlexNet: Dog vs. Cat Classification | Just Code with Khanh"/><meta name="description" content="Dog and cat image classification with machine learning"/><meta name="twitter:description" content="Dog and cat image classification with machine learning"/><meta name="og:description" content="Dog and cat image classification with machine learning"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Just Code with Khanh"/><meta name="twitter:image" content="https://justcodewithkhanh.com/img/logo_with_background.jpg"/><meta name="og:image" content="https://justcodewithkhanh.com/img/logo_with_background.jpg"/></head><body class="item-page"><div id="header"><div class="wrapper"><div class="inner"><div class="logo"><a href="/"><img src="/img/logo_expand.png"/></a><p class="description">Learning by doing. Just start coding!!! üë®üèª‚Äçüíª</p></div><nav><ul><li class="nav-swift"><a href="/swift">Swift</a></li><li class="nav-leetcode"><a href="/leetcode">LeetCode</a></li><li class="nav-project"><a class="selected" href="/project">Project</a></li><li class="nav-aboutme"><a href="/aboutMe">About Me</a></li></ul></nav></div></div></div><div id="main"><div class="wrapper"><div class="inner"><article><div class="content"><img src="https://raw.githubusercontent.com/Insignite/Alexnet-DogvsCat-Classification/master/img/AlexNet-1.png" alt="Thumbnail"/><h1><strong>Keras AlexNet: Dog vs. Cat Classification</strong></h1><p><strong>You can view project code <a href="https://github.com/Insignite/Alexnet-DogvsCat-Classification">here</a>.</strong></p><p>I want to build a simple Deep Learning model for image classification on <a href="https://www.kaggle.com/c/dogs-vs-cats">Kaggle Dog vs. Cat Dataset</a>. In this project, I decided to use AlexNet architecture as it repeatedly mention during my Machine Learning course. This project is simple enough that helps me understand Alexnet, familiarize with Keras, and gain more experience in ML field.</p><h3><strong>Dataset</strong></h3><img src="https://raw.githubusercontent.com/Insignite/Alexnet-DogvsCat-Classification/master/img/2.PNG" alt="sample img"/><p>After download and extract dataset from zip file, let's view the data.</p><img src="https://raw.githubusercontent.com/Insignite/Alexnet-DogvsCat-Classification/master/img/1.PNG" alt="img1"/><p>The dataset doesn't come with a label file. But I can extract the label from image name in train dataset.</p><img src="https://raw.githubusercontent.com/Insignite/Alexnet-DogvsCat-Classification/master/img/3.PNG" alt="img3"/><p>I apply data generator to provide variety to our train dataset which definitely will improve the model accuracy. This also "replicate" real world dataset because not all input image will be a perfect picture of a dog or a cat. Let's view a sample from our generator.</p><img src="https://raw.githubusercontent.com/Insignite/Alexnet-DogvsCat-Classification/master/img/4.PNG" alt="img4"/><p>The train dataset split as 80% training and 20% validation with image generator applied to both. Data now ready to be train.</p><h3><strong>Deep Learning Model</strong></h3><p>As mentioned, I will be using AlexNet architecture to build the model. AlexNet consist of five convolutional layers, some followed by maximum pooling layers and then three fully connected layers. Since the dataset only consist of two classes (Dog and Cat), the last layer is a 2-ways softwax.</p><table>
    <tr>
        <th>Layer name</th>
        <th>Output</th>
        <th>Filters</th>
        <th>Kernel size</th>
        <th>Stride</th>
        <th>Padding</th>
    </tr>
    <tr>
        <th>Input</th>
        <th>227x227x3</th>
        <th>-</th>
        <th>-</th>
        <th>-</th>
        <th>-</th>
    </tr>
    <tr>
        <th>Convol_1</th>
        <th>55x55x96</th>
        <th>96</th>
        <th>11x11</th>
        <th>4</th>
        <th>valid</th>
    </tr>
    <tr>
        <th>MaxPool_1</th>
        <th>27x27x96</th>
        <th>-</th>
        <th>3x3</th>
        <th>2</th>
        <th>valid</th>
    </tr>
    <tr>
        <th>Norm_1</th>
        <th>27x27x96</th>
        <th>-</th>
        <th>-</th>
        <th>-</th>
        <th>-</th>
    </tr>
    <tr>
        <th>Convol_2</th>
        <th>27x27x256</th>
        <th>256</th>
        <th>5x5</th>
        <th>1</th>
        <th>valid</th>
    </tr>
    <tr>
        <th>MaxPool_2</th>
        <th>13x13x256</th>
        <th>-</th>
        <th>3x3</th>
        <th>2</th>
        <th>valid</th>
    </tr>
    <tr>
        <th>Norm_2</th>
        <th>13x13x256</th>
        <th>-</th>
        <th>-</th>
        <th>-</th>
        <th>-</th>
    </tr>
    <tr>
        <th>Convol_3</th>
        <th>13x13x384</th>
        <th>384</th>
        <th>3x3</th>
        <th>1</th>
        <th>valid</th>
    </tr>
    <tr>
        <th>Convol_4</th>
        <th>13x13x384</th>
        <th>384</th>
        <th>3x3</th>
        <th>1</th>
        <th>valid</th>
    </tr>
    <tr>
        <th>Convol_5</th>
        <th>13x13x256</th>
        <th>256</th>
        <th>3x3</th>
        <th>1</th>
        <th>valid</th>
    </tr>
    <tr>
        <th>MaxPool_3</th>
        <th>6x6x256</th>
        <th>-</th>
        <th>3x3</th>
        <th>2</th>
        <th>valid</th>
    </tr>
    <tr>
        <th>FulConnect_1</th>
        <th>4096</th>
        <th>-</th>
        <th>-</th>
        <th>-</th>
        <th>-</th>
    </tr>
    <tr>
        <th>FulConnect_2</th>
        <th>4096</th>
        <th>-</th>
        <th>-</th>
        <th>-</th>
        <th>-</th>
    </tr>
    <tr>
        <th>FulConnect_3</th>
        <th>1000</th>
        <th>-</th>
        <th>-</th>
        <th>-</th>
        <th>-</th>
    </tr>
    <tr>
        <th>FulConnect_4</th>
        <th>2 (DogvCat)</th>
        <th>-</th>
        <th>-</th>
        <th>-</th>
        <th>-</th>
    </tr>
</table><h3><strong>Training</strong></h3><p>I am using a Huaweii Matebook Pro with 8th Gen Intel- i7, 16GB RAM, NVIDIA GeForce MX150. Definitely not a good laptop to run any type of machine learning project so each epochs take me roughly 10-15 minutes. I decided to use small epochs but reasonable enough to get decent result. I tried out with 3, then 10, and finally 20 epochs. If you have a stronger hardware, increase to 50 or so definitely will yield a good result.</p><img src="https://raw.githubusercontent.com/Insignite/Alexnet-DogvsCat-Classification/master/img/5.PNG" alt="img5"/><p>Let's graph the train lost, train accuracy, validation lost, and validation accuracy for 20 epochs.</p><img src="https://raw.githubusercontent.com/Insignite/Alexnet-DogvsCat-Classification/master/img/6.PNG" alt="img6"/><h3><strong>Result</strong></h3><img src="https://raw.githubusercontent.com/Insignite/Alexnet-DogvsCat-Classification/master/img/8.PNG" alt="img8"/><p>Let's put some predicted result with images so we can see our prediction result better. I will do first 20 images from test result.</p><img src="https://raw.githubusercontent.com/Insignite/Alexnet-DogvsCat-Classification/master/img/7.PNG" alt="result img"/><p>TADA!!! I now have a simple model to classify picture of dog or cat.</p></div><span>Tagged with: </span><ul class="tag-list"><li class="color-d"><a href="/tags/tensorflow">tensorflow</a></li><li class="color-b"><a href="/tags/alexnet">alexnet</a></li></ul></article></div></div><div><a class="pagination next" href="/project/svm-food-101-dataset-classification">SVM Food-101 Dataset Classification</a><a class="pagination previous" href="/project/angular-real-time-message-website">Angular Messaging Website With Log In System</a></div></div><footer id="footer"><div class="wrapper"><div class="inner"><p><a href="/aboutMe"><img id="profile" src="/img/profile_img_circle.png" alt="Khanh"/></a></p><p>üë®üèª‚Äçüíª A Swift fan. üìö</p><p>Copyright ¬© Khanh Nguyen 2020.</p><p>Powered by <a href="https://github.com/johnsundell/publish">Publish.</a></p></div></div></footer></body></html>